trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(trw)
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(trw)
rbind(genes,list(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(trw)
rbind(genes,list(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(trw)
rbind(genes,list(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(trw)
rbind(genes,list(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
?rbind
?rbind
?cbind
?rownames
View(t)
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
View(genes)
rbind(genes,c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[1],pos[2]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
rbind(genes,c(trw[[1]][2],pos[1],pos[2]))
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[[1]],pos[[2]]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
fix(pos)
pos <- strsplit(trw[[1]][4],'-')
fix(pos)
fix(pos)
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[1],pos[2]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
genes
fix(pos)
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[1],pos[2][-1]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
fix(pos)
fix(trw)
rbind(genes,c(trw[[1]][2],pos[1],pos[2][-1]))
rbind(genes,c(trw[[1]][2],pos[1],pos[2]))
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
rbind(genes,c(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,c(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
print(genes)
}
#print(nchar(toString(t$X.NEXUS[i])))
}
?rbind
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
#print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
rbind(genes,as.matrix(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix("",nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
#print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
tm <- matrix(nrow=1,ncol=3)
tm[1,1] <- trw[[1]][2]
tm[1,2] <- pos[[1]][1]
tm[1,3] <- pos[[1]][2]
rbind(genes,tm)
}
#print(nchar(toString(t$X.NEXUS[i])))
}
View(genes)
View(tm)
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
#print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
tm <- matrix(nrow=1,ncol=3)
tm[1,1] <- trw[[1]][2]
tm[1,2] <- pos[[1]][1]
tm[1,3] <- pos[[1]][2]
rbind(genes,tm)
}
#print(nchar(toString(t$X.NEXUS[i])))
}
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
#print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
tm <- matrix(nrow=1,ncol=3)
tm[1,1] <- trw[[1]][2]
tm[1,2] <- pos[[1]][1]
tm[1,3] <- pos[[1]][2]
genes<-rbind(genes,tm)
}
#print(nchar(toString(t$X.NEXUS[i])))
}
View(genes)
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
#print(c(trw[[1]][2],trw[[1]][4],trw[[1]][4]))
pos <- strsplit(trw[[1]][4],'-')
tm <- matrix(nrow=1,ncol=3)
tm[1,1] <- trw[[1]][2]
tm[1,2] <- pos[[1]][1]
tm[1,3] <- pos[[1]][2]
genes<-rbind(genes,c(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
}
#print(nchar(toString(t$X.NEXUS[i])))
}
View(genes)
genes(2:,)
genes[2:,]
genes[2:length(genes),]
genes[2:length(genes)]
t<-read.delim("/home/ilya/Dropbox/DecisivatoR/Testing/Data/Campanulid_Complete_Dataset_77_Taxa.nex",sep='\n')
genes <- matrix(nrow=1, ncol=3)
for(i in seq(1,dim(t)[1])) {
if(length(grep('CHARSET', t$X.NEXUS[i])) > 0)  {
trw <- strsplit(toString(t$X.NEXUS[i]),' ')
pos <- strsplit(trw[[1]][4],'-')
genes<-rbind(genes,c(trw[[1]][2],pos[[1]][1],pos[[1]][2]))
}
}
genes <- data.frame(genes[2:length(genes)])
genes
?data.frame
goog <- read.csv(file='~/bio/rtricks/GOOG-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(goog) <- tolower( colnames(goog) )
goog$date <- as.Date( as.character( goog$date ) )
goog <- goog[order(goog$date),]
# util functions
summary30 <- function( x, FUN, na.rm=F ){
val <- rep( 0, length( x ) )
for( j in 1:length( x ) ){
val[ j ] <- FUN( x[ max( j - 29, 1 ):j ], na.rm=na.rm)
}
val
}
goog$close30 <- ma30(goog$close)
goog2 <- goog[ goog$date >= as.Date('2008-01-01'),]
plot(x=goog2$date, y=goog2$close, ylim=c(0,1.1*max(goog2$close)),col='black', type='l',main='goog stock close', xlab='date', ylab='close ($)',xaxt='n')
points(x=goog2$date, y=goog2$close30, col='green', type='l', lwd=2)
points(x=yahoo2$date, y=yahoo2$close, col='black', type='l')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l')
goog <- read.csv(file='~/bio/rtricks/GOOG-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(goog) <- tolower( colnames(goog) )
goog$date <- as.Date( as.character( goog$date ) )
goog <- goog[order(goog$date),]
yahoo <- read.csv(file='~/bio/rtricks/YHOO-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(yahoo) <- tolower( colnames(yahoo) )
yahoo$date <- as.Date( as.character( yahoo$date ) )
yahoo <- yahoo[order(yahoo$date),]
# util functions
summary30 <- function( x, FUN, na.rm=F ){
val <- rep( 0, length( x ) )
for( j in 1:length( x ) ){
val[ j ] <- FUN( x[ max( j - 29, 1 ):j ], na.rm=na.rm)
}
val
}
goog$close30 <- ma30(goog$close)
goog2 <- goog[ goog$date >= as.Date('2008-01-01'),]
yahoo$close30 <- ma30(yahoo$close)
yahoo2 <- yahoo[ yahoo$date >= as.Date('2008-01-01'),]
plot(x=goog2$date, y=goog2$close, ylim=c(0,1.1*max(goog2$close)),col='black', type='l',main='goog stock close', xlab='date', ylab='close ($)',xaxt='n')
points(x=goog2$date, y=goog2$close30, col='green', type='l', lwd=2)
points(x=yahoo2$date, y=yahoo2$close, col='black', type='l')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l')
yat <- pretty(c(0, 35))
# add extra room to the left of the plot
par(oma=c(0,2,0,0))
# plot, but don't label any of the axes
plot(x=goog2$date, y=goog2$close, ylim=c(0,700),col='blue', type='l',main='Google (GOOG) vs Yahoo (YHOO) stock close', xlab='date', ylab='',xaxt='n', yaxt='n', lwd=0.75)
points(x=goog2$date, y=goog2$close30, col='blue', type='l', lwd=2.5)
# manually label axis 2, left, with the ratio calculated above times our manual label locations
axis(2, col='blue', at=20*yat, labels=20*yat)
# tell R to draw over the current plot with a new one
par(new=T)
plot(x=yahoo2$date, y=yahoo2$close, ylim=c(0,35),col='red', type='l', lwd=0.75,xaxt='n', axes=F, ylab='')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l', lwd=2.5)
# label the yahoo data
axis(side=2, at=yat, labels=yat, col='red', line=2)
# manually label, farther out than normal, the Y axis
yat <- pretty(c(0, 35))
# add extra room to the left of the plot
par(oma=c(0,2,0,0))
# plot, but don't label any of the axes
#plot(x=goog2$date, y=goog2$close, ylim=c(0,700),col='blue', type='l',main='Google (GOOG) vs Yahoo (YHOO) stock close', xlab='date', ylab='',xaxt='n', yaxt='n', lwd=0.75)
#points(x=goog2$date, y=goog2$close30, col='blue', type='l', lwd=2.5)
# manually label axis 2, left, with the ratio calculated above times our manual label locations
axis(2, col='blue', at=20*yat, labels=20*yat)
# tell R to draw over the current plot with a new one
par(new=T)
#plot(x=yahoo2$date, y=yahoo2$close, ylim=c(0,35),col='red', type='l', lwd=0.75,xaxt='n', axes=F, ylab='')
#points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l', lwd=2.5)
# label the yahoo data
axis(side=2, at=yat, labels=yat, col='red', line=2)
# manually label, farther out than normal, the Y axis
mtext(side=2, line=4, 'close ($)')
yat <- pretty(c(0, 35))
# add extra room to the left of the plot
par(oma=c(0,2,0,0))
# plot, but don't label any of the axes
#plot(x=goog2$date, y=goog2$close, ylim=c(0,700),col='blue', type='l',main='Google (GOOG) vs Yahoo (YHOO) stock close', xlab='date', ylab='',xaxt='n', yaxt='n', lwd=0.75)
plot.new()
#points(x=goog2$date, y=goog2$close30, col='blue', type='l', lwd=2.5)
# manually label axis 2, left, with the ratio calculated above times our manual label locations
axis(2, col='blue', at=20*yat, labels=20*yat)
# tell R to draw over the current plot with a new one
par(new=T)
#plot(x=yahoo2$date, y=yahoo2$close, ylim=c(0,35),col='red', type='l', lwd=0.75,xaxt='n', axes=F, ylab='')
#points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l', lwd=2.5)
# label the yahoo data
axis(side=2, at=yat, labels=yat, col='red', line=2)
# manually label, farther out than normal, the Y axis
mtext(side=2, line=4, 'close ($)')
fix(yat)
goog <- read.csv(file='~/bio/rtricks/GOOG-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(goog) <- tolower( colnames(goog) )
goog$date <- as.Date( as.character( goog$date ) )
goog <- goog[order(goog$date),]
yahoo <- read.csv(file='~/bio/rtricks/YHOO-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(yahoo) <- tolower( colnames(yahoo) )
yahoo$date <- as.Date( as.character( yahoo$date ) )
yahoo <- yahoo[order(yahoo$date),]
# util functions
summary30 <- function( x, FUN, na.rm=F ){
val <- rep( 0, length( x ) )
for( j in 1:length( x ) ){
val[ j ] <- FUN( x[ max( j - 29, 1 ):j ], na.rm=na.rm)
}
val
}
goog$close30 <- ma30(goog$close)
goog2 <- goog[ goog$date >= as.Date('2008-01-01'),]
yahoo$close30 <- ma30(yahoo$close)
yahoo2 <- yahoo[ yahoo$date >= as.Date('2008-01-01'),]
plot(x=goog2$date, y=goog2$close, ylim=c(0,1.1*max(goog2$close)),col='black', type='l',main='goog stock close', xlab='date', ylab='close ($)',xaxt='n')
points(x=goog2$date, y=goog2$close30, col='green', type='l', lwd=2)
points(x=yahoo2$date, y=yahoo2$close, col='black', type='l')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l')
# create label locations for the yahoo data -- pretty values for the range [0, 35]
yat <- pretty(c(0, 35))
# add extra room to the left of the plot
par(oma=c(0,2,0,0))
# plot, but don't label any of the axes
plot(x=goog2$date, y=goog2$close, ylim=c(0,700),col='blue', type='l',main='Google (GOOG) vs Yahoo (YHOO) stock close', xlab='date', ylab='',xaxt='n', yaxt='n', lwd=0.75)
plot.new()
goog <- read.csv(file='~/bio/rtricks/GOOG-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(goog) <- tolower( colnames(goog) )
goog$date <- as.Date( as.character( goog$date ) )
goog <- goog[order(goog$date),]
yahoo <- read.csv(file='~/bio/rtricks/YHOO-stock-prices-19960412-20090702.csv', header=T, sep=',')
colnames(yahoo) <- tolower( colnames(yahoo) )
yahoo$date <- as.Date( as.character( yahoo$date ) )
yahoo <- yahoo[order(yahoo$date),]
# util functions
summary30 <- function( x, FUN, na.rm=F ){
val <- rep( 0, length( x ) )
for( j in 1:length( x ) ){
val[ j ] <- FUN( x[ max( j - 29, 1 ):j ], na.rm=na.rm)
}
val
}
goog$close30 <- ma30(goog$close)
goog2 <- goog[ goog$date >= as.Date('2008-01-01'),]
yahoo$close30 <- ma30(yahoo$close)
yahoo2 <- yahoo[ yahoo$date >= as.Date('2008-01-01'),]
plot(x=goog2$date, y=goog2$close, ylim=c(0,1.1*max(goog2$close)),col='black', type='l',main='goog stock close', xlab='date', ylab='close ($)',xaxt='n')
points(x=goog2$date, y=goog2$close30, col='green', type='l', lwd=2)
points(x=yahoo2$date, y=yahoo2$close, col='black', type='l')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l')
# create label locations for the yahoo data -- pretty values for the range [0, 35]
yat <- pretty(c(0, 35))
# add extra room to the left of the plot
par(oma=c(0,2,0,0))
# plot, but don't label any of the axes
plot(x=goog2$date, y=goog2$close, ylim=c(0,700),col='blue', type='l',main='Google (GOOG) vs Yahoo (YHOO) stock close', xlab='date', ylab='',xaxt='n', yaxt='n', lwd=0.75)
points(x=goog2$date, y=goog2$close30, col='blue', type='l', lwd=2.5)
# manually label axis 2, left, with the ratio calculated above times our manual label locations
axis(2, col='blue', at=20*yat, labels=20*yat)
# tell R to draw over the current plot with a new one
par(new=T)
plot(x=yahoo2$date, y=yahoo2$close, ylim=c(0,35),col='red', type='l', lwd=0.75,xaxt='n', axes=F, ylab='')
points(x=yahoo2$date, y=yahoo2$close30, col='red', type='l', lwd=2.5)
# label the yahoo data
axis(side=2, at=yat, labels=yat, col='red', line=2)
# manually label, farther out than normal, the Y axis
mtext(side=2, line=4, 'close ($)')
?abline
?seq
?boxplot
?data.frame
?text
#SlopMap test scripts
#Different k-mer sizes and thresholds were used
library(seqinr)
library(Rsamtools)
#Run Blat several times with different tile size
for(k in seq(8,15)) {
cmd <- paste("~/bin/x86_64/blat ~/bio/slop_map_test/ecoli/02-Genes/lclU00096.2_gene_1206.fasta /home/ilya/bio/slop_map_test/ecoli/00-RawData/GO37VCR01.fasta -tileSize=", toString(k) ," ~/bio/slop_map_test/test_blat/test454_lclU00096.2_gene_1206_k",toString(k),".psl", sep='')
print(cmd)
system(cmd)
}
xx <- seq(8,15,1)
plot(xx,blat.data[1,],col="red",xlab="% of similarity",ylab="Number of reads",type ="l", main = "Number of reads vs. % of similarity for different kmer sizes")
#Run Bowtie2 several times with different tile size
for(k in seq(8,15)) {
cmd <- paste("~/bin/x86_64/bowtie2 -L ", toString(k)," -x ~/bio/slop_map_test/test_bowtie2/lclU00096.2_gene_1206.index -U /home/ilya/bio/slop_map_test/ecoli/00-RawData/GO37VCR01.fastq -S ~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".sam", sep='')
print(cmd)
system(cmd)
cmd <- paste("~/bin/x86_64/samtools view -bS ~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".sam > ~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".bam", sep='')
system(cmd)
}
bowtie2.data <- matrix(0, nrow=1,
ncol=8,
byrow = TRUE)
j<-1
for(k in seq(8,15)) {
bw2.data <- readBamGappedAlignments(paste("~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".bam",sep=''),use.names=T)
bowtie2.data[1,j] <- length(bw2.data@NAMES)
j <- j + 1
}
xx <- seq(8,15,1)
plot(xx,bowtie2.data[1,],col="red",xlab="% of similarity",ylab="Number of reads",type ="l", main = "Number of reads vs. % of similarity for different kmer sizes")
#Run BWA
cmd <- "~/bin/x86_64/bwa index ~/bio/slop_map_test/ecoli/02-Genes/lclU00096.2_gene_1206.fasta -p ~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.index"
print(cmd)
system(cmd)
cmd <- "~/bin/x86_64/bwa bwasw ~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.index /home/ilya/bio/slop_map_test/ecoli/00-RawData/GO37VCR01.fasta -f ~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.sam"
print(cmd)
system(cmd)
cmd <- paste("~/bin/x86_64/samtools view -bS ~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.sam > ~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.bam", sep='')
system(cmd)
bwa.d <- readBamGappedAlignments("~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.bam",use.names=T)
bwa.data <- length(bwa.d@NAMES)
#Run SOAP
setwd("~/bio/slop_map_test/test_soap/")
cmd <- "~/bin/x86_64/2bwt-builder ~/bio/slop_map_test/ecoli/02-Genes/lclU00096.2_gene_1206.fasta"
print(cmd)
system(cmd)blat.data <- matrix(0, nrow=1,
ncol=8,
byrow = TRUE)
j<-1
for(k in seq(8,15)) {
b.data <- read.table(paste("~/bio/slop_map_test/test_blat/test454_lclU00096.2_gene_1206_k",toString(k),".psl",sep=''),header = FALSE, sep = "\t", skip = 5)
blat.data[1,j] <- length(b.data$V10)
j <- j + 1
}
cmd <- "~/bin/x86_64/soap -D ~/bio/slop_map_test/test_soap/lclU00096.2_gene_1206.fasta.index -a /home/ilya/bio/slop_map_test/ecoli/00-RawData/GO37VCR01.fasta -o ~/bio/slop_map_test/test_soap/lclU00096.2_gene_1206.txt"
print(cmd)
system(cmd)
soap.d <- readBamGappedAlignments("~/bio/slop_map_test/test_soap/lclU00096.2_gene_1206.bam",use.names=T)
bwa.data <- length(bwa.d@NAMES)
#######SlopMap
setwd("~/bio/app/SlopMap/")
#SlopMap test scripts
#Different k-mer sizes and thresholds were used
#k=7..15
##t=0.1..1.0
for(k in seq(7,15)) {
for(t in seq(0.10,1.00,0.1)) {
cmd <- paste("bin/./slopmap -454 ~/bio/slop_map_test/ecoli/00-RawData/GO37VCR01.sff -o ~/bio/slop_map_test/test/test454_lclU00096.2_gene_1206_t",toString(t),"_k",toString(k)," -l ~/bio/slop_map_test/ecoli/02-Genes/lclU00096.2_gene_1206.fasta -t ", toString(t), " -k ", toString(k), sep='')
print(cmd)
system(cmd)
}
}
?par
?readBamGappedAlignments
j<-1
for(k in seq(8,15)) {
bw2.data <- readBamGappedAlignments(paste("~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".bam",sep=''),use.names=T)
bowtie2.data[1,j] <- length(bw2.data@NAMES)
j <- j + 1
}
bowtie2.data <- matrix(0, nrow=1,
ncol=8,
byrow = TRUE)
j<-1
for(k in seq(8,15)) {
bw2.data <- readBamGappedAlignments(paste("~/bio/slop_map_test/test_bowtie2/test454_lclU00096.2_gene_1206_k",toString(k),".bam",sep=''),use.names=T)
bowtie2.data[1,j] <- length(bw2.data@NAMES)
j <- j + 1
}
bwa.d <- readBamGappedAlignments("~/bio/slop_map_test/ecoli/03-Testing/test_bwa/lclU00096.2_gene_1206.bam",use.names=T)
bwa.data <- length(bwa.d@NAMES)
